@inject CommonLocalizationService Localizer
@inject NavigationManager MyNavigationManager
@inject AppState _AppState



<nav class="navbar-expand-md  navbar-dark bg-dark border-bottom box-shadow mb-3 fixed-top">
    <div class="container-fluid">
         
        <div class="col-sm-12">
            <a class="navbar-toggler" @onclick="ToggleNavMenu" type="button">
                <span class="navbar-toggler-icon"></span>
            </a>
           <a class="navbar-brand" href="/">
                <img alt="SAPPER H.C.M." src="/images/SAPPER-CLOUD_logo.png" width="200">
            </a>            
        </div>

        <div class="col-sm-12">
            
            <div class="@NavMenuCssClass" >
                
                <ul class="navbar-nav flex-grow-1">
                    <li class="nav-item" @onclick="ToggleNavMenu">
                        <NavLink class="nav-link" href="/" Match="NavLinkMatch.All" @onmousedown="() => expandAdmin = false">@Localizer.Str["MainMenu_Home"]</NavLink>                            
                    </li>
                    <li class="nav-item" @onclick="ToggleNavMenu">
                        <NavLink class="nav-link" href="/Cases"  Match="NavLinkMatch.Prefix" @onmousedown="() => expandAdmin = false">@Localizer.Str["MainMenu_MyCases"]</NavLink>                            
                    </li>

                    <li class="nav-item" @onclick="ToggleNavMenu">
                        <NavLink class="nav-link" href="/Reports"  Match="NavLinkMatch.Prefix" @onmousedown="() => expandAdmin = false">@Localizer.Str["MainMenu_Reports"]</NavLink>                            
                    </li>

                    <li class="nav-item">
                        <NavLink class="nav-link" href="admin/" @onclick:preventDefault @onmousedown="() => expandAdmin = !expandAdmin"  Match="NavLinkMatch.Prefix" >@Localizer.Str["MainMenu_Administration"]</NavLink>                            
                    </li>

                </ul>
            </div>
        </div>


        @if (expandAdmin)
        {
            <div class="col-sm-12">
               <div class="@NavMenuCssClass" @onclick="ToggleNavMenu">
                    <ul class="navbar-nav flex-grow-1">
                        <li class="@(NewLocation.Contains("admin/profiles") ? "nav-item-set" : "nav-item")">
                            <NavLink class="nav-link" href="admin/profiles/ProfileList" Match="NavLinkMatch.Prefix">@Localizer.Str["Menu_Profiles"]</NavLink>
                        </li>
                        <li class="@(NewLocation.Contains("admin/users/UserList") ? "nav-item-set" : "nav-item")">
                            <NavLink class="nav-link" href="admin/users/UserList"  Match="NavLinkMatch.Prefix">@Localizer.Str["Menu_Users"]</NavLink>
                        </li>
                        <li class="@(NewLocation.Contains("admin/settings") ? "nav-item-set" : "nav-item")">
                            <NavLink class="nav-link" href="admin/settings"  Match="NavLinkMatch.Prefix">@Localizer.Str["Menu_Settings"]</NavLink>
                        </li>
                    </ul>
               </div>
            </div>

        }
        <div class="col-sm-12 text-right">
            <LoginDisplay />
        </div>
           
    </div>
</nav>


@code {

    bool collapseNavMenu = true;
    bool expandAdmin = false;

    string baseMenuClass = " navbar-collapse d-xl-inline-flex ";

    string NavMenuCssClass => baseMenuClass + (collapseNavMenu ? " collapse" : "");

    public string NewLocation { get; set; } = "";


    void ToggleNavMenu()
    {
        collapseNavMenu = !collapseNavMenu;
    }

}
